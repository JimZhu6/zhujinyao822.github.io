---
title: "前端优化方案"
categories: "资料类"
date: 2018-5-27 16:47:37
---

> 总结了当前前端大部分性能优化的相关方法（搬运工）

<!--more-->

### DNS相关

#### 何为DNS

&nbsp;&nbsp;&nbsp;&nbsp;DNS（Domain Name System)域名解析系统，可以看做是网络上**域名**和**IP地址**相互映射的一个分布式数据库。作用是将域名转换成IP地址反馈给用户计算机，然后用户计算机再根据IP地址找到目标服务器进行访问。

#### DNS缓存

&nbsp;&nbsp;&nbsp;&nbsp;DNS可以短暂地缓存到客户端，缓存的作用是可以当用户成功的通过域名进入了一个页面后，系统会将此次通过DNS获取到的IP地址暂时缓存到客户端，在以后用户再次输入域名的时候，系统会优先调取缓存在本地的IP地址。通过DNS缓存能减少客户端向DNS获取IP地址所消耗的时间（约20ms-120ms）

#### DNS优化

##### 通过DNS缓存

&nbsp;&nbsp;&nbsp;&nbsp;不同的浏览器的DNS缓存机制也不同：IE对DNS记录默认的缓存时间为30分钟，Firefox对DNS记录默认的缓存时间为1分钟，Chrome对DNS记录默认的缓存时间为1分钟。

缓存时间长：能减少DNS重复请求，能有效节省时间

缓存时间段：及时检测服务器的IP变化，保证访问的正确性。

>附:[各主流浏览器修改DNS缓存时间、清除系统DNS缓存的方法](https://blog.csdn.net/charleslei/article/details/51083442)

##### 减少DNS查询次数

&nbsp;&nbsp;&nbsp;&nbsp;如果你的网站里的资源指向多个域名下，那么DNS将会多次查询各个域名对应的IP，这样会消耗时间。理想的做法是将网站的资源都指向一个域名，但这样会带来另一个问题：在HTTP /1.1 中推荐客户端针对每个域只有一定数量的并行度（它的建议是2），那么就会出现下载资源时的排队现象，这样就会降低性能。一般情况下，建议在**一个网站里面使用至少2个域，但不多于4个域**来提供资源。

##### DNS预解析

&nbsp;&nbsp;&nbsp;&nbsp;通过该使用html的link标签的rel属性设置为`dns-prefetch`来启动域名预解析

```html
<link rel="dns-prefetch" href="//****">
```

&nbsp;&nbsp;&nbsp;&nbsp;当加载完当前页面后，客户端将会根据设置的href地址对DNS进行预加载，节省时间。但**切记不可滥用该属性**

### 请求数据相关

#### 减少HTTP请求

##### 对资源进行打包、压缩、合并等操作

服务器端开启gzip压缩

&nbsp;&nbsp;&nbsp;&nbsp;服务器开启gzip压缩后，js代码文件大小将会减少约70%，[具体开启方法点这里](https://pagespeed.webkaka.com/docs/EnableCompression.html)

##### 避免重定向

> 重定向：客户浏览器发送http请求----》web服务器接受后发送302/301状态码响应及对应新的location给客户浏览器--》客户浏览器发现是302/301响应，则**自动**再发送一个新的http请求，请求url是新的location地址----》服务器根据此请求寻找资源并发送给客户。

所以，重定向也会间接增加了页面打开时事件

&nbsp;&nbsp;&nbsp;&nbsp;另外，要注意的是**慎用**302重定向，因为：302重定向很容易被搜索引擎误认为是利用多个域名指向同一网站，那么你的网站就会被封掉，罪名是“利用重复的内容来干扰Google搜索结果的网站排名”。

##### 减少不必要的请求

&nbsp;&nbsp;&nbsp;&nbsp;这一项包含了很多内容，例如：不必要的CSS、js引入，不必要的DNS预解析等...

##### 优先使用外链

&nbsp;&nbsp;&nbsp;&nbsp;客户端加载页面时，需要在服务器端拉取资源，然而在同一个服务器同时拉取资源是有数量限制的，具体如下：

- IE6：最大并发数2
- IE8+、Firefox、Chrome：最大并发数6

所以，当页面里需要加载的资源多时，可以考虑使用外链，例如：引入CSS、js代码使用CDN，图片多的使用类似七牛等的云存储托管等...

##### js代码（包含引入的代码）编写在html结构底部

&nbsp;&nbsp;&nbsp;&nbsp;IE低版本的内核不会对html结构进行分析，会直接将html从上到下按顺序加载（引入）资源，且在IE6版本中js文件会阻塞后面所有的资源的加载。所以做兼容的伙伴们就要注意了

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;另外：对于性能优化，可以使用script标签的defer属性来使页面加载完成才执行js代码或者使用async属性来进行异步执行

##### 图片资源优化

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;使用[img-2](https://github.com/RevillWeb/img-2) 。可以代替img标签，它能做到在页面加载时，图片的原图在还没加载完成时，先用一张你准备好的小图片进行模糊显示，等原图加载完成时把图片渲染出来（需要IE11+）

##### 资源懒加载

​	[webpack懒加载](https://webpack.docschina.org/guides/lazy-loading)



<hr>

#### 参考文档：

[浅谈前端性能优化（九）——DNS解析优化](https://blog.csdn.net/zhouziyu2011/article/details/71351967)

[优化页面的打开速度，要不要了解一下](https://juejin.im/post/5afd6a88f265da0b9127a879?utm_source=gold_browser_extension)

[大前端性能总结](https://juejin.im/post/5b025d856fb9a07aa0484e54?utm_source=gold_browser_extension)

[HTTP中的重定向和请求转发的区别](https://blog.csdn.net/meiyalei/article/details/2129120/)

[资源并行数](https://www.cnblogs.com/x_wukong/p/3926059.html?utm_source=tuicool&utm_medium=referralFirefox3.6)